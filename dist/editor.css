:root{--color-bg-primary: #1a1a1a;--color-bg-secondary: #151515;--color-bg-tertiary: #0d0d0d;--color-bg-header: #0d0d0d;--color-bg-input: #2a2a2a;--color-bg-button: linear-gradient(180deg, #2a2a2a 0%, #222 100%);--color-bg-button-hover: linear-gradient(180deg, #333 0%, #2a2a2a 100%);--color-bg-button-primary: linear-gradient(180deg, #2d4a2d 0%, #1e3a1e 100%);--color-bg-button-primary-hover: linear-gradient(180deg, #3d5a3d 0%, #2d4a2d 100%);--color-bg-button-danger: linear-gradient(180deg, #4a2d2d 0%, #3a1e1e 100%);--color-bg-button-danger-hover: linear-gradient(180deg, #5a3d3d 0%, #4a2d2d 100%);--color-text-primary: #d0d0d0;--color-text-secondary: #888;--color-text-muted: #666;--color-text-dim: #555;--color-text-accent: #8a8;--color-text-choice: #8ac;--color-text-ending: #ca8;--color-border-primary: #333;--color-border-secondary: #444;--color-border-focus: #555;--color-border-accent: #3a4a3a;--color-scrollbar-track: #1a1a1a;--color-scrollbar-thumb: #333;--color-scrollbar-thumb-hover: #444;--font-ui: "Segoe UI", system-ui, -apple-system, sans-serif;--font-story: Georgia, "Times New Roman", serif;--font-mono: "Consolas", "Monaco", monospace;--font-size-base: 1rem;--font-size-sm: .85rem;--font-size-xs: .8rem;--font-size-xxs: .75rem;--font-size-story: 1.15rem;--line-height-base: 1.5;--line-height-story: 1.85;--spacing-xs: .25rem;--spacing-sm: .5rem;--spacing-md: .75rem;--spacing-lg: 1rem;--spacing-xl: 1.5rem;--spacing-xxl: 2rem;--radius-sm: 3px;--radius-md: 4px;--radius-lg: 6px;--radius-xl: 8px;--transition-fast: .15s ease;--transition-normal: .2s ease}:root.light-theme{--color-bg-primary: #f5f5f5;--color-bg-secondary: #ffffff;--color-bg-tertiary: #e8e8e8;--color-bg-header: #ffffff;--color-bg-input: #ffffff;--color-bg-button: linear-gradient(180deg, #f0f0f0 0%, #e0e0e0 100%);--color-bg-button-hover: linear-gradient(180deg, #e8e8e8 0%, #d8d8d8 100%);--color-bg-button-primary: linear-gradient(180deg, #4a8a4a 0%, #3a7a3a 100%);--color-bg-button-primary-hover: linear-gradient(180deg, #5a9a5a 0%, #4a8a4a 100%);--color-bg-button-danger: linear-gradient(180deg, #c44 0%, #a33 100%);--color-bg-button-danger-hover: linear-gradient(180deg, #d55 0%, #b44 100%);--color-text-primary: #333;--color-text-secondary: #666;--color-text-muted: #888;--color-text-dim: #aaa;--color-text-accent: #2a6a2a;--color-text-choice: #2a4a6a;--color-text-ending: #8a4a2a;--color-border-primary: #ddd;--color-border-secondary: #ccc;--color-border-focus: #999;--color-border-accent: #4a8a4a;--color-scrollbar-track: #f0f0f0;--color-scrollbar-thumb: #ccc;--color-scrollbar-thumb-hover: #bbb}*{box-sizing:border-box;margin:0;padding:0}html,body{height:100%}body{font-family:var(--font-ui);background:var(--color-bg-primary);color:var(--color-text-primary);font-size:var(--font-size-base);line-height:var(--line-height-base)}button{background:var(--color-bg-button);color:#ccc;border:1px solid var(--color-border-primary);padding:.4rem 1rem;font-family:inherit;font-size:var(--font-size-sm);cursor:pointer;border-radius:var(--radius-md);transition:all var(--transition-fast)}button:hover{background:var(--color-bg-button-hover);border-color:var(--color-border-secondary);color:#fff}button:active{transform:translateY(1px)}button.primary{background:var(--color-bg-button-primary);border-color:#3d5a3d}button.primary:hover{background:var(--color-bg-button-primary-hover);border-color:#4d6a4d}button.danger{background:var(--color-bg-button-danger);border-color:#5a3d3d}button.danger:hover{background:var(--color-bg-button-danger-hover)}button:disabled{opacity:.5;cursor:not-allowed}input,textarea,select{background:var(--color-bg-input);border:1px solid var(--color-border-secondary);color:var(--color-text-primary);padding:.5rem .75rem;font-family:inherit;font-size:var(--font-size-sm);border-radius:var(--radius-md);transition:border-color var(--transition-normal),box-shadow var(--transition-normal)}input:focus,textarea:focus,select:focus{outline:none;border-color:var(--color-border-focus);box-shadow:0 0 0 3px #ffffff0d}input::placeholder,textarea::placeholder{color:var(--color-text-dim)}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:var(--color-scrollbar-track)}::-webkit-scrollbar-thumb{background:var(--color-scrollbar-thumb);border-radius:var(--radius-md)}::-webkit-scrollbar-thumb:hover{background:var(--color-scrollbar-thumb-hover)}.modal-overlay{display:none;position:fixed;inset:0;background:#000000b3;z-index:100;align-items:center;justify-content:center}.modal-overlay.visible{display:flex}.modal{background:var(--color-bg-primary);border:1px solid var(--color-border-primary);border-radius:var(--radius-xl);padding:var(--spacing-xl);max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal h3{font-size:1rem;font-weight:400;margin-bottom:var(--spacing-lg);color:var(--color-text-secondary)}.modal-buttons{display:flex;gap:var(--spacing-md);justify-content:flex-end;margin-top:var(--spacing-xl)}.hidden{display:none!important}.visually-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.text-mono{font-family:var(--font-mono)}.text-muted{color:var(--color-text-muted)}.text-accent{color:var(--color-text-accent)}.kbd{display:inline-block;padding:.1rem .4rem;font-family:var(--font-mono);font-size:.75rem;background:var(--color-bg-tertiary);border:1px solid var(--color-border-primary);border-radius:var(--radius-sm);box-shadow:0 1px 0 var(--color-border-primary)}.toast-container{position:fixed;bottom:var(--spacing-xl);right:var(--spacing-xl);z-index:200;display:flex;flex-direction:column;gap:var(--spacing-sm)}.toast{background:var(--color-bg-secondary);border:1px solid var(--color-border-primary);border-radius:var(--radius-md);padding:var(--spacing-md) var(--spacing-lg);font-size:var(--font-size-sm);box-shadow:0 4px 12px #0000004d;animation:slideIn .3s ease}.toast.success{border-left:3px solid #4a8a4a}.toast.error{border-left:3px solid #8a4a4a}.toast.warning{border-left:3px solid #8a6a3a}@keyframes slideIn{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}.spinner{width:20px;height:20px;border:2px solid var(--color-border-primary);border-top-color:var(--color-text-accent);border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.font-size-small{--font-size-story: .95rem}.font-size-medium{--font-size-story: 1.15rem}.font-size-large{--font-size-story: 1.35rem}.font-size-xlarge{--font-size-story: 1.55rem}html,body{overflow:hidden}body{display:flex;flex-direction:column}header{background:var(--color-bg-header);border-bottom:1px solid var(--color-border-primary);padding:var(--spacing-md) var(--spacing-xl);display:flex;justify-content:space-between;align-items:center;flex-shrink:0;gap:var(--spacing-lg)}header h1{font-size:1.1rem;font-weight:400;color:var(--color-text-secondary);letter-spacing:.05em;white-space:nowrap}.header-controls{display:flex;gap:var(--spacing-md);align-items:center;flex-wrap:wrap}.header-controls input{width:180px}.draft-controls{display:flex;align-items:center;gap:var(--spacing-sm)}.draft-controls select{max-width:150px;cursor:pointer}.main-container{display:flex;flex:1;overflow:hidden}.sidebar{width:280px;background:var(--color-bg-secondary);border-right:1px solid var(--color-border-primary);display:flex;flex-direction:column;flex-shrink:0}.sidebar-header{padding:var(--spacing-lg);border-bottom:1px solid var(--color-border-primary);display:flex;justify-content:space-between;align-items:center}.sidebar-header h2{font-size:var(--font-size-xs);font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--color-text-muted)}.sidebar-toolbar{padding:var(--spacing-sm) var(--spacing-lg);border-bottom:1px solid var(--color-border-primary);display:flex;gap:var(--spacing-sm);align-items:center}.sidebar-toolbar input{flex:1;padding:var(--spacing-xs) var(--spacing-sm);font-size:var(--font-size-xs)}.page-tree{flex:1;overflow-y:auto;padding:var(--spacing-sm)}.page-item{padding:.6rem var(--spacing-md);margin-bottom:2px;border-radius:var(--radius-md);cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-size:var(--font-size-sm);transition:background var(--transition-fast);border:1px solid transparent}.page-item:hover{background:#252525}.page-item.active{background:#2a3a2a;border-color:var(--color-border-accent)}.page-item.search-match{background:#3a3a2a}.page-item.orphan{border-left:3px solid #ca8}.page-item.dead-end{border-left:3px solid #8ac}.page-item .page-id{font-family:var(--font-mono);color:var(--color-text-accent)}.page-item .page-badges{display:flex;gap:var(--spacing-xs)}.page-item .page-type{font-size:.7rem;padding:.15rem .4rem;border-radius:var(--radius-sm);background:var(--color-border-primary);color:var(--color-text-secondary)}.page-item .page-type.choice{background:#2a3a4a;color:var(--color-text-choice)}.page-item .page-type.ending{background:#4a3a2a;color:var(--color-text-ending)}.page-item.dragging{opacity:.5}.page-item.drag-over{border-top:2px solid var(--color-text-accent)}.editor-panel{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0}.editor-header{padding:var(--spacing-lg) var(--spacing-xl);border-bottom:1px solid var(--color-border-primary);background:#1d1d1d;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--spacing-md)}.editor-header h2{font-size:1rem;font-weight:400;color:var(--color-text-secondary)}.editor-header h2 span{font-family:var(--font-mono);color:var(--color-text-accent)}.page-options{display:flex;gap:var(--spacing-lg);align-items:center;flex-wrap:wrap}.page-options label{display:flex;align-items:center;gap:var(--spacing-xs);font-size:var(--font-size-sm);color:var(--color-text-secondary);cursor:pointer}.page-options input[type=checkbox]{cursor:pointer}.editor-content{flex:1;display:flex;flex-direction:column;padding:var(--spacing-xl);gap:var(--spacing-lg);overflow-y:auto}.editor-section{display:flex;flex-direction:column;gap:var(--spacing-sm)}.editor-section label{font-size:var(--font-size-xxs);text-transform:uppercase;letter-spacing:.05em;color:var(--color-text-muted)}.textarea-wrapper{position:relative;flex:1;display:flex;min-height:200px}.line-numbers{position:absolute;left:0;top:0;bottom:0;width:40px;background:#0a0a0a;border:1px solid var(--color-border-primary);border-right:none;border-radius:var(--radius-md) 0 0 var(--radius-md);padding:var(--spacing-lg) var(--spacing-sm);font-family:var(--font-mono);font-size:var(--font-size-sm);line-height:1.7;color:var(--color-text-dim);text-align:right;overflow:hidden;user-select:none}textarea#page-content{flex:1;background:var(--color-bg-tertiary);border:1px solid var(--color-border-primary);color:var(--color-text-primary);padding:var(--spacing-lg);padding-left:50px;font-family:var(--font-story);font-size:1rem;line-height:1.7;border-radius:var(--radius-md);resize:none}textarea#page-content:focus{outline:none;border-color:var(--color-border-focus)}textarea#page-content.drag-over{border-color:#5a8a5a;background:#0d1a0d}.preview-panel{flex:1;display:none;flex-direction:column;overflow:hidden}.preview-panel.visible{display:flex}.preview-content{flex:1;padding:var(--spacing-xl);overflow-y:auto;font-family:var(--font-story);font-size:var(--font-size-story);line-height:var(--line-height-story)}.preview-content p{margin-bottom:1.25rem}.preview-content .story-image{display:block;max-width:100%;margin:1.5rem auto;border-radius:var(--radius-md);box-shadow:0 4px 20px #00000080}.choices-section{display:none;gap:var(--spacing-md)}.choices-section.visible{display:flex;flex-direction:column}.choice-row{display:flex;gap:var(--spacing-md);align-items:center}.choice-row .choice-label{font-family:var(--font-mono);font-size:var(--font-size-sm);color:var(--color-text-choice);width:24px;flex-shrink:0}.choice-row input{flex:1;background:var(--color-bg-tertiary);padding:.6rem var(--spacing-md);font-size:.95rem}.choice-row .goto-input{width:80px;flex:none;font-family:var(--font-mono)}.assets-panel{width:260px;background:var(--color-bg-secondary);border-left:1px solid var(--color-border-primary);display:flex;flex-direction:column;flex-shrink:0}.assets-header{padding:var(--spacing-lg);border-bottom:1px solid var(--color-border-primary);display:flex;flex-direction:column;gap:var(--spacing-md)}.assets-header h2{font-size:var(--font-size-xs);font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--color-text-muted)}.file-input-wrapper{position:relative;overflow:hidden}.file-input-wrapper input[type=file]{position:absolute;top:0;left:0;opacity:0;width:100%;height:100%;cursor:pointer;z-index:10}.assets-list{flex:1;overflow-y:auto;padding:var(--spacing-sm)}.asset-preview{padding:var(--spacing-sm);border-bottom:1px solid var(--color-border-primary)}.asset-preview img,.asset-preview video{max-width:100%;max-height:150px;border-radius:var(--radius-md)}.asset-hint{padding:var(--spacing-lg);font-size:var(--font-size-xs);color:var(--color-text-dim);text-align:center}.asset-item{padding:var(--spacing-sm) var(--spacing-md);margin-bottom:2px;border-radius:var(--radius-md);display:flex;justify-content:space-between;align-items:center;font-size:var(--font-size-sm);background:#1d1d1d;cursor:grab;user-select:none;position:relative}.asset-item:hover{background:#252525}.asset-item:active{cursor:grabbing}.asset-item.dragging{opacity:.5}.asset-item .asset-name{font-family:var(--font-mono);color:var(--color-text-secondary);transition:color var(--transition-fast)}.asset-item .asset-name:hover{color:#fff}.asset-item button{padding:.2rem var(--spacing-sm);font-size:var(--font-size-xxs)}.asset-tooltip{display:none;position:absolute;right:100%;top:50%;transform:translateY(-50%);margin-right:var(--spacing-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border-primary);border-radius:var(--radius-md);padding:var(--spacing-sm);z-index:50;max-width:200px}.asset-item:hover .asset-tooltip{display:block}.asset-tooltip img,.asset-tooltip video{max-width:100%;max-height:150px;border-radius:var(--radius-sm)}.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--color-text-dim);text-align:center;padding:var(--spacing-xxl)}.empty-state p{margin-bottom:var(--spacing-lg)}.graph-panel{display:none;position:fixed;inset:60px 20px 20px;background:var(--color-bg-primary);border:1px solid var(--color-border-primary);border-radius:var(--radius-lg);z-index:50;flex-direction:column}.graph-panel.visible{display:flex}.graph-header{padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--color-border-primary);display:flex;justify-content:space-between;align-items:center}.graph-container{flex:1;min-height:0}.stats-bar{padding:var(--spacing-sm) var(--spacing-lg);background:var(--color-bg-header);border-top:1px solid var(--color-border-primary);display:flex;gap:var(--spacing-xl);font-size:var(--font-size-xs);color:var(--color-text-muted)}.stats-bar .stat-item{display:flex;gap:var(--spacing-xs)}.stats-bar .stat-label{text-transform:uppercase;letter-spacing:.03em}.stats-bar .stat-value{color:var(--color-text-secondary);font-family:var(--font-mono)}.validation-list{max-height:300px;overflow-y:auto}.validation-item{padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--color-border-primary);display:flex;gap:var(--spacing-md);align-items:flex-start}.validation-item:last-child{border-bottom:none}.validation-item .validation-icon{font-size:1rem}.validation-item.warning .validation-icon{color:#ca8}.validation-item.error .validation-icon{color:#c66}.validation-item.info .validation-icon{color:#8ac}.validation-item .validation-text{flex:1}.validation-item .validation-page{font-family:var(--font-mono);color:var(--color-text-accent);cursor:pointer}.validation-item .validation-page:hover{text-decoration:underline}.metadata-section{padding:var(--spacing-lg);border-bottom:1px solid var(--color-border-primary)}.metadata-section h3{font-size:var(--font-size-xxs);text-transform:uppercase;letter-spacing:.05em;color:var(--color-text-muted);margin-bottom:var(--spacing-md)}.metadata-field{margin-bottom:var(--spacing-md)}.metadata-field label{display:block;font-size:var(--font-size-xs);color:var(--color-text-muted);margin-bottom:var(--spacing-xs)}.metadata-field input,.metadata-field textarea{width:100%}.metadata-field textarea{min-height:80px;resize:vertical}@media (max-width: 900px){.main-container{flex-direction:column}.sidebar{width:100%;height:auto;max-height:200px;border-right:none;border-bottom:1px solid var(--color-border-primary)}.assets-panel{width:100%;height:auto;max-height:200px;border-left:none;border-top:1px solid var(--color-border-primary)}.sidebar.collapsed,.assets-panel.collapsed{max-height:50px;overflow:hidden}.collapse-toggle{display:block;width:100%;text-align:center;padding:var(--spacing-sm);background:var(--color-bg-tertiary);cursor:pointer}header{flex-wrap:wrap;padding:var(--spacing-md)}.header-controls{width:100%;justify-content:center}}.shortcuts-panel{position:fixed;bottom:var(--spacing-lg);left:50%;transform:translate(-50%);background:var(--color-bg-secondary);border:1px solid var(--color-border-primary);border-radius:var(--radius-lg);padding:var(--spacing-lg);z-index:100;display:none}.shortcuts-panel.visible{display:block}.shortcuts-grid{display:grid;grid-template-columns:auto 1fr;gap:var(--spacing-sm) var(--spacing-lg)}.save-status{display:flex;align-items:center;gap:var(--spacing-sm);font-size:var(--font-size-xs);color:var(--color-text-muted)}.save-status.saving{color:var(--color-text-choice)}.save-status.saved{color:var(--color-text-accent)}.save-status.error{color:var(--color-text-ending)}.import-zone{border:2px dashed var(--color-border-primary);border-radius:var(--radius-lg);padding:var(--spacing-xxl);text-align:center;cursor:pointer;transition:border-color var(--transition-fast),background var(--transition-fast)}.import-zone:hover,.import-zone.drag-over{border-color:var(--color-text-accent);background:#8aaa8a0d}.import-zone input[type=file]{display:none}
